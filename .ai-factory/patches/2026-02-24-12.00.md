# Docker build: git not found, uv sync exit code 1

**Date:** 2026-02-24 12:00
**Files:** Dockerfile, .github/workflows/docker-publish-release.yml
**Severity:** medium

## Problem

Docker build failed with:
- WARN: "current commit information was not captured by the build" — git not found in $PATH
- Process failed: exit code 1 in the RUN step (apk add … && uv sync … && apk del …)

## Root Cause

1. **WARN:** Docker Buildx by default enables provenance/attestation and may need git to capture commit info; Alpine base image does not include git.
2. **Exit 1:** Either (a) some step in the build (e.g. a PEP 517 backend or tool) invoked git and failed, or (b) attestation/provenance logic ran in a context where git was missing and caused the overall step to fail.

## Solution

- **Dockerfile:** Added `git` to the virtual `.build-deps` in the deps stage so it is available during `uv sync` (and any backend that might call git). Removed with `apk del .build-deps …`, so the final image size is unchanged.
- **CI:** Set `provenance: false` and `sbom: false` in `docker/build-push-action` so Buildx does not require git for attestations.

## Prevention

- When using minimal images (Alpine) for build, include `git` in build-deps if any dependency might be built from source or use version-from-git.
- For CI builds where attestations are not required, disable provenance/sbom to avoid dependency on git in the build environment.

## Tags

`#docker` `#alpine` `#buildx` `#uv` `#ci`
