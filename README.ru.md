# –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

–ù—É–∂–µ–Ω GSM-–º–æ–¥–µ–º, —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π —Å Gammu: https://wammu.eu/phones/  
–î–∞–∂–µ –µ—Å–ª–∏ –≤–∞—à–µ–π –º–æ–¥–µ–ª–∏ –Ω–µ—Ç –≤ —Å–ø–∏—Å–∫–µ, —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ –æ–Ω –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å.

–ï—Å–ª–∏ –Ω—É–∂–Ω—ã –æ—Å–æ–±—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Gammu ‚Äî –º–æ–∂–Ω–æ –æ—Ç–∫—Ä—ã—Ç—å PR –∏–ª–∏ issue.

# –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

![–°—Ö–µ–º–∞](https://raw.githubusercontent.com/Domochip/sms2mqtt/master/diagram.svg)

–ü—Ä–∏ –ø–æ—Ç–µ—Ä–µ —Å–≤—è–∑–∏ —Å MQTT-–±—Ä–æ–∫–µ—Ä–æ–º —Å–µ—Ä–≤–∏—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è —Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π (–≤–º–µ—Å—Ç–æ –≤—ã—Ö–æ–¥–∞). –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –ø—Ä–∏ –∫—Ä–∞—Ç–∫–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–±—Ä—ã–≤–∞—Ö —Å–µ—Ç–∏.

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

**–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** –í –ø—Ä–∏–º–µ—Ä–∞—Ö –Ω–∏–∂–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∑–∞–≥–ª—É—à–∫–∏ (`1234`, `pass` –∏ —Ç.–¥.). –ù–µ –ø–æ–¥—Å—Ç–∞–≤–ª—è–π—Ç–µ —Ä–µ–∞–ª—å–Ω—ã–µ PIN SIM –∏ –ø–∞—Ä–æ–ª–∏ MQTT –≤ –ø—Ä–∏–º–µ—Ä—ã –∏ –≤ —Ñ–∞–π–ª—ã, –ø–æ–ø–∞–¥–∞—é—â–∏–µ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π. –í –ø—Ä–æ–¥–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏–ª–∏ —Å–µ–∫—Ä–µ—Ç—ã (Docker secrets, `.env` –Ω–µ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏).

–ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker:

```bash
docker run \
    -d \
    --name sms2mqtt \
    --restart=always \
    --device=/dev/ttyUSB0:/dev/mobile \
    -e PIN="1234" \
    -e HOST="192.168.1.x" \
    -e PORT=8883 \
    -e PREFIX="sms2mqtt" \
    -e CLIENTID="sms2mqttclid" \
    -e USER="usr" \
    -e PASSWORD="pass" \
    -e USETLS=true \
    domochip/sms2mqtt
```

–í –æ–±—Ä–∞–∑–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω HEALTHCHECK ‚Äî Compose/Kubernetes –º–æ–≥—É—Ç –ø–æ–º–µ—á–∞—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∫–∞–∫ –Ω–µ—Ä–∞–±–æ—á–∏–π –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ –ø—Ä–æ—Ü–µ—Å—Å–∞.

–î–ª—è Docker Compose:

```yaml
version: '3'
services:
  sms2mqtt:
    container_name: sms2mqtt
    image: domochip/sms2mqtt
    devices:
      - /dev/serial/by-id/usb-HUAWEI_HUAWEI_Mobile-if00-port0:/dev/mobile
    environment:
      - PIN=1234
      - HOST=10.0.0.2
      - PORT=8883
      - PREFIX=sms2mqtt
      - CLIENTID=sms2mqttclid
      - USER=mqtt_username
      - PASSWORD=mqtt_password
      - USETLS=true
    restart: always
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞

#### –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ
* `device`: –ü—É—Ç—å –∫ GSM-–º–æ–¥–µ–º—É (–ø–æ–¥—Å—Ç–∞–≤—å—Ç–µ —Å–≤–æ–π –≤–º–µ—Å—Ç–æ /dev/ttyUSB0), –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ –æ–Ω –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω –∫–∞–∫ /dev/mobile.

*–ü—É—Ç—å `/dev/ttyUSBx` –º–æ–∂–µ—Ç –º–µ–Ω—è—Ç—å—Å—è –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ ‚Äî –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `/dev/serial/by-id/` –∏–ª–∏ udev-–ø—Ä–∞–≤–∏–ª–∞ —Å —Å–∏–º–ª–∏–Ω–∫–∞–º–∏.*

#### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
* `DEVICE`: **–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ.** –ü—É—Ç—å –∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤—É GSM-–º–æ–¥–µ–º–∞. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: `/dev/mobile`. –í Docker —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ —Ö–æ—Å—Ç–∞ –æ–±—ã—á–Ω–æ –º–∞–ø—è—Ç –≤ `/dev/mobile` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `--device=/dev/ttyUSB0:/dev/mobile`). –ù–∞ —Ö–æ—Å—Ç–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `/dev/serial/by-id/...` –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–≥–æ –ø—É—Ç–∏ –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏.
* `PIN`: **–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ.** PIN-–∫–æ–¥ SIM-–∫–∞—Ä—Ç—ã.
* `GAMMUOPTION`: **–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ.** –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ –≤ –∫–æ–Ω—Ñ–∏–≥ Gammu (–Ω–∞–ø—Ä–∏–º–µ—Ä: `'atgen_setcnmi = 1,2,0,0'`).
* `MOREINFO`: **–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ.** –í–∫–ª—é—á–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–æ–ø–∏–∫–∏ (–±–∞—Ç–∞—Ä–µ—è, —Å–µ—Ç—å).
* `HEARTBEAT`: **–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ.** –í–∫–ª—é—á–∏—Ç—å —Ç–æ–ø–∏–∫ heartbeat.
* `HOST`: IP –∏–ª–∏ hostname MQTT-–±—Ä–æ–∫–µ—Ä–∞.
* `PORT`: **–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ.** –ü–æ—Ä—Ç MQTT-–±—Ä–æ–∫–µ—Ä–∞ (–¥–ª—è TLS –æ–±—ã—á–Ω–æ 8883). –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: 1883.
* `PREFIX`: **–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ.** –ü—Ä–µ—Ñ–∏–∫—Å —Ç–æ–ø–∏–∫–æ–≤ MQTT. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: `sms2mqtt`.
* `CLIENTID`: **–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ.** –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä MQTT-–∫–ª–∏–µ–Ω—Ç–∞. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: `sms2mqtt`.
* `USER`: **–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ.** –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è MQTT.
* `PASSWORD`: **–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ.** –ü–∞—Ä–æ–ª—å MQTT.
* `USETLS`: **–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ.** –í–∫–ª—é—á–∏—Ç—å MQTT —á–µ—Ä–µ–∑ TLS. –ó–Ω–∞—á–µ–Ω–∏—è: `true`, `1`, `yes` (–±–µ–∑ —É—á—ë—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞). –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: –≤—ã–∫–ª—é—á–µ–Ω–æ. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–∏—Å—Ç–µ–º–Ω—ã–π –Ω–∞–±–æ—Ä CA (certifi). –ü—Ä–∏ TLS –æ–±—ã—á–Ω–æ –∑–∞–¥–∞—é—Ç `PORT=8883`.
* `DEVMODE`: **–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ.** –ï—Å–ª–∏ `1` ‚Äî –ø—Ä–æ—Ü–µ—Å—Å –∂–¥—ë—Ç –Ω–∞–∂–∞—Ç–∏—è Enter –ø–µ—Ä–µ–¥ –æ—Å–Ω–æ–≤–Ω—ã–º —Ü–∏–∫–ª–æ–º (—É–¥–æ–±–Ω–æ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏). –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: `0`.
* `SMS_MAX_TEXT_LENGTH`: **–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ.** –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ —Ç–µ–∫—Å—Ç–∞ SMS –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ; –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –æ—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏. –ü—É—Å—Ç–æ –∏–ª–∏ –Ω–µ –∑–∞–¥–∞–Ω–æ ‚Äî –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è.
* `LOG_LEVEL`: **–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ.** –£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è: `DEBUG`, `INFO`, `WARNING`, `ERROR`. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: `INFO`.

## –û—Ç–ø—Ä–∞–≤–∫–∞ SMS

–ü—Ä–µ—Ñ–∏–∫—Å —Ç–æ–ø–∏–∫–æ–≤ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é ‚Äî sms2mqtt.

–ß—Ç–æ–±—ã –æ—Ç–ø—Ä–∞–≤–∏—Ç—å SMS:
1. –û–ø—É–±–ª–∏–∫—É–π—Ç–µ –≤ —Ç–æ–ø–∏–∫ **sms2mqtt/send** payload:  
   `{"number":"+33612345678", "text":"–¢–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ"}`
2. SMS –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è.
3. –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø—Ä–∏—Ö–æ–¥–∏—Ç –≤ MQTT —Ç–æ–ø–∏–∫ **sms2mqtt/sent**:  
   `{"result":"success", "datetime":"2021-01-23 13:00:00", "number":"+33612345678", "text":"–¢–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ"}`

- ‚úîÔ∏è –û—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –Ω–æ–º–µ—Ä–æ–≤ —á–µ—Ä–µ–∑ —Ç–æ—á–∫—É —Å –∑–∞–ø—è—Ç–æ–π (;) ‚Äî –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–æ –∫–∞–∂–¥–æ–º—É.
- ‚úîÔ∏è –î–ª–∏–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è (–±–æ–ª—å—à–µ 160 —Å–∏–º–≤–æ–ª–æ–≤).
- ‚úîÔ∏è Unicode –∏ —ç–º–æ–¥–∑–∏: `{"number":"+33612345678", "text":"–†–∞–±–æ—Ç–∞–µ—Ç üëå"}`.
- ‚úîÔ∏è –î–ª–∏–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è —Å —ç–º–æ–¥–∑–∏.

## –ü—Ä–∏—ë–º SMS

–í—Ö–æ–¥—è—â–∏–µ SMS –ø—É–±–ª–∏–∫—É—é—Ç—Å—è –≤ —Ç–æ–ø–∏–∫ **sms2mqtt/received**:  
`{"datetime":"2021-01-23 13:30:00", "number":"+31415926535", "text":"–¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è"}`

- ‚úîÔ∏è –î–ª–∏–Ω–Ω—ã–µ SMS.
- ‚ùå MMS –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è.

## –û—Å—Ç–∞–ª—å–Ω—ã–µ —Ç–æ–ø–∏–∫–∏

| –¢–æ–ø–∏–∫ | –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|-------------|----------|
| `{prefix}/send` | –≤–≤–æ–¥ | –û—Ç–ø—Ä–∞–≤–∫–∞ SMS (JSON: number, text) |
| `{prefix}/sent` | –≤—ã–≤–æ–¥ | –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ –∏–ª–∏ –æ—à–∏–±–∫–∞ |
| `{prefix}/received` | –≤—ã–≤–æ–¥ | –í—Ö–æ–¥—è—â–∏–µ SMS |
| `{prefix}/connected` | –≤—ã–≤–æ–¥ | –°—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (0 –∏–ª–∏ 1) |
| `{prefix}/signal` | –≤—ã–≤–æ–¥ | –£—Ä–æ–≤–µ–Ω—å —Å–∏–≥–Ω–∞–ª–∞ |
| `{prefix}/control` | –≤–≤–æ–¥ | –ö–æ–º–∞–Ω–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä delete_stuck_sms) |
| `{prefix}/control_response` | –≤—ã–≤–æ–¥ | –û—Ç–≤–µ—Ç –Ω–∞ –∫–æ–º–∞–Ω–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è |
| `{prefix}/stuck_status` | –≤—ã–≤–æ–¥ | –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ ¬´–∑–∞—Å—Ç—Ä—è–≤—à–∞—è¬ª –º–Ω–æ–≥—á–∞—Å—Ç–Ω–∞—è SMS |
| `{prefix}/battery` | –≤—ã–≤–æ–¥ | –ë–∞—Ç–∞—Ä–µ—è (–ø—Ä–∏ MOREINFO) |
| `{prefix}/network` | –≤—ã–≤–æ–¥ | –°–µ—Ç—å (–ø—Ä–∏ MOREINFO) |
| `{prefix}/datetime` | –≤—ã–≤–æ–¥ | –í—Ä–µ–º—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (–ø—Ä–∏ HEARTBEAT) |

- **sms2mqtt/connected**: –°—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ (0 –∏–ª–∏ 1). –ü—Ä–∏–º–µ—Ä: `1`.

- **sms2mqtt/signal**: –ü—É–±–ª–∏–∫—É–µ—Ç—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —É—Ä–æ–≤–Ω—è —Å–∏–≥–Ω–∞–ª–∞.  
  –ü—Ä–∏–º–µ—Ä: `{"SignalStrength": -71, "SignalPercent": 63, "BitErrorRate": -1}`.

- **sms2mqtt/control** (–ø–æ–¥–ø–∏—Å–∫–∞): –ö–∞–Ω–∞–ª —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è. –û–ø—É–±–ª–∏–∫—É–π—Ç–µ JSON —Å `"action": "delete_stuck_sms"`, —á—Ç–æ–±—ã —É–¥–∞–ª–∏—Ç—å SMS, –∑–∞—Å—Ç—Ä—è–≤—à–∏–µ –≤ –Ω–µ–ø–æ–ª–Ω–æ–º –º–Ω–æ–≥—á–∞—Å—Ç–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏. –û—Å—Ç–∞–ª—å–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è (–ª–æ–≥–∏—Ä—É—é—Ç—Å—è –∫–∞–∫ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–µ).

- **sms2mqtt/control_response** (–ø—É–±–ª–∏–∫–∞—Ü–∏—è): –û—Ç–≤–µ—Ç –Ω–∞ –∫–æ–º–∞–Ω–¥—ã. –ù–∞–ø—Ä–∏–º–µ—Ä: `{"result": "deleted", "deleted_locations": [1, 2]}` –∏–ª–∏ `{"result": "nothing", "deleted_locations": []}`.

- **sms2mqtt/stuck_status** (–ø—É–±–ª–∏–∫–∞—Ü–∏—è): –ü—É–±–ª–∏–∫—É–µ—Ç—Å—è –ø—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ –Ω–µ–ø–æ–ª–Ω–æ–π –º–Ω–æ–≥—á–∞—Å—Ç–Ω–æ–π SMS. –í payload: `status`, `received_parts`, `expected_parts`, `number`, `datetime`, `locations`. –û—á–∏—Å—Ç–∫—É –º–æ–∂–Ω–æ –≤—ã–∑–≤–∞—Ç—å, –æ—Ç–ø—Ä–∞–≤–∏–≤ –≤ `{prefix}/control` –∫–æ–º–∞–Ω–¥—É `{"action": "delete_stuck_sms"}`.

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–æ–ø–∏–∫–∏ (—Ñ–ª–∞–≥ MOREINFO)
- **sms2mqtt/battery**: –ü—É–±–ª–∏–∫—É–µ—Ç—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö –æ –±–∞—Ç–∞—Ä–µ–µ.  
  –ü—Ä–∏–º–µ—Ä: `{"BatteryPercent": 100, "ChargeState": "BatteryPowered", ...}`

- **sms2mqtt/network**: –ü—É–±–ª–∏–∫—É–µ—Ç—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö –æ —Å–µ—Ç–∏.  
  –ü—Ä–∏–º–µ—Ä: `{"NetworkName": "", "State": "HomeNetwork", "NetworkCode": "392 11", ...}`

### –¢–æ–ø–∏–∫ heartbeat (—Ñ–ª–∞–≥ HEARTBEAT)
- **sms2mqtt/datetime**: –ü—É–±–ª–∏–∫—É–µ—Ç—Å—è —Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è GSM-—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –Ω–∞ –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏.  
  –ü—Ä–∏–º–µ—Ä: `1634671168.531913`

## –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ SMS –≤ –ë–î

–ß—Ç–æ–±—ã —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –≤—Ö–æ–¥—è—â–∏–µ –∏ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ SMS –≤ PostgreSQL, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å [sms2mqtt-persistence](sms2mqtt-persistence/). –û–Ω –ø–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –Ω–∞ `{prefix}/received` –∏ `{prefix}/sent` –∏ –ø–∏—à–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ –ë–î. –ó–∞–ø—É—Å–∫: `docker compose -f docker-compose.persistence.yml --profile persistence up -d` (–ø–æ–¥—Ä–æ–±–Ω–µ–µ –≤ [sms2mqtt-persistence/README.md](sms2mqtt-persistence/README.md)).

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- **TLS:** –í –ø—Ä–æ–¥–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è MQTT —á–µ—Ä–µ–∑ TLS: `USETLS=true` (–∏–ª–∏ `1`/`yes`) –∏ `PORT=8883`. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –Ω–∞–±–æ—Ä CA (certifi); –¥–ª—è —Å–≤–æ–∏—Ö CA –∏–ª–∏ –∫–ª–∏–µ–Ω—Ç—Å–∫–∏—Ö —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–æ—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–¥–∞.
- **–°–µ–∫—Ä–µ—Ç—ã:** –ù–µ —Ö—Ä–∞–Ω–∏—Ç–µ —Ä–µ–∞–ª—å–Ω—ã–µ PIN SIM –∏ –ø–∞—Ä–æ–ª–∏ MQTT –≤ –ø—Ä–∏–º–µ—Ä–∞—Ö –∏ –≤ —Ñ–∞–π–ª–∞—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è, Docker secrets –∏–ª–∏ `.env` –≤–Ω–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è (—Å–º. –ø—Ä–∏–º–µ—á–∞–Ω–∏–µ –≤ —Ä–∞–∑–¥–µ–ª–µ [–£—Å—Ç–∞–Ω–æ–≤–∫–∞](#—É—Å—Ç–∞–Ω–æ–≤–∫–∞)).
- **ACL:** –ö—Ç–æ –º–æ–∂–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å SMS –∏ –≤—ã–ø–æ–ª–Ω—è—Ç—å –∫–æ–º–∞–Ω–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è, –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ ACL –±—Ä–æ–∫–µ—Ä–∞ MQTT (–∫—Ç–æ –∏–º–µ–µ—Ç –ø—Ä–∞–≤–æ –ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –≤ `{prefix}/send` –∏ `{prefix}/control`). –û—Ç–¥–µ–ª—å–Ω–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–µ—Ç. –û–≥—Ä–∞–Ω–∏—á—å—Ç–µ –ø—É–±–ª–∏–∫–∞—Ü–∏—é –≤ —ç—Ç–∏ —Ç–æ–ø–∏–∫–∏ –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã–º–∏ –∫–ª–∏–µ–Ω—Ç–∞–º–∏.

# –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ [uv](https://docs.astral.sh/uv/) (–±–µ–∑ pip –∏ requirements.txt). –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –∏ –ª–∏–Ω—Ç–µ—Ä–∞ –ª–æ–∫–∞–ª—å–Ω–æ (–±–µ–∑ –º–æ–¥–µ–º–∞ –∏ MQTT):

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ uv –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
   ```bash
   uv sync --extra dev
   ```
   –î–ª—è –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ persistence:
   ```bash
   cd sms2mqtt-persistence && uv sync --extra dev
   ```

2. –¢–µ—Å—Ç—ã:
   ```bash
   uv run pytest tests/ -v
   cd sms2mqtt-persistence && uv run pytest tests/ -v
   ```

3. –õ–∏–Ω—Ç–µ—Ä:
   ```bash
   uv run ruff check .
   uv run ruff format --check .
   ```

# –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

## –õ–æ–≥–∏
–ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:  
`docker logs sms2mqtt`

# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ

–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±—Ä–∞–∑–∞:
```bash
docker stop sms2mqtt
docker rm sms2mqtt
docker rmi domochip/sms2mqtt
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å–Ω–æ–≤–∞ ‚Äî Docker –ø–æ–¥—Ç—è–Ω–µ—Ç –Ω–æ–≤—ã–π –æ–±—Ä–∞–∑.
```

# –ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏

–°–ø–∞—Å–∏–±–æ –∞–≤—Ç–æ—Ä–∞–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ—Å–ª—É–∂–∏–ª–∏ –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–º:
* https://github.com/pajikos/sms-gammu-gateway
* https://github.com/pkropf/mqtt2sms

---

–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º: [README.md](README.md).
